set GLOBAL query_cache_size=1355776;
flush query cache;
flush query cache;
reset query cache;
flush status;
DROP TABLE IF EXISTS t;
CREATE TABLE t(id INT, number INT);
INSERT INTO t VALUES (0,1);
INSERT INTO t VALUES (1,2);
INSERT INTO t VALUES (2,3);
SELECT number from t where id > 0;
number
2
3
SET SESSION debug="+d,status_wait_query_cache_mutex_sleep";
SELECT number from t where id > 0;
SELECT number from t where id > 0;
SET SESSION debug="+d,status_wait_query_cache_mutex_sleep";
SHOW PROCESSLIST;
Id	User	Host	db	Command	Time	State	Info
2	root	localhost	test	Sleep	0		NULL
3	root	localhost	test	Query	0	Waiting on query cache mutex	SELECT number from t where id > 0
4	root	localhost	test	Query	0	Waiting on query cache mutex	SELECT number from t where id > 0
5	root	localhost	test	Query	0	NULL	SHOW PROCESSLIST
DROP TABLE t;
set GLOBAL query_cache_size=0;
