stop slave;
drop table if exists t1,t2,t3,t4,t5,t6,t7,t8,t9;
reset master;
reset slave;
drop table if exists t1,t2,t3,t4,t5,t6,t7,t8,t9;
start slave;
DROP TABLE IF EXISTS t;
CREATE TABLE t(id INT);
INSERT INTO t VALUES (0), (1), (2), (3), (4), (5), (6), (7);
START SLAVE;
Warnings:
Note	1254	Slave is already running
SELECT SLEEP(0.1),id from t where id = 1;
SLEEP(0.1)	id
set global log_slow_slave_statements=ON;
SELECT SLEEP(0.1),id from t where id = 2;
SLEEP(0.1)	id
0	2
STOP SLAVE;
START SLAVE;
SELECT SLEEP(0.1),id from t where id = 3;
SLEEP(0.1)	id
0	3
set global log_slow_slave_statements=OFF;
SELECT SLEEP(0.1),id from t where id = 4;
SLEEP(0.1)	id
0	4
STOP SLAVE;
START SLAVE;
SELECT SLEEP(0.1),id from t where id = 5;
SLEEP(0.1)	id
0	5
cat ./var/mysqld.2/data/percona_log_slow_slave_statements-slave.log | grep "SELECT SLEEP(0.1),id from t where id = 5" | wc -l
1
cat ./var/mysqld.2/data/percona_log_slow_slave_statements-slave.log | grep "SELECT SLEEP(0.1),id from t where id = 4" | wc -l
1
cat ./var/mysqld.2/data/percona_log_slow_slave_statements-slave.log | grep "SELECT SLEEP(0.1),id from t where id = 3" | wc -l
1
cat ./var/mysqld.2/data/percona_log_slow_slave_statements-slave.log | grep "SELECT SLEEP(0.1),id from t where id = 2" | wc -l
1
cat ./var/mysqld.2/data/percona_log_slow_slave_statements-slave.log | grep "SELECT SLEEP(0.1),id from t where id = 1" | wc -l
0
DROP TABLE t;
